# DIL: 쉽게 배우는 운영체제

> 작성일: 2025-03-07<br/>
> 작성자: iamkanguk97<br/>
> 읽은 책 범위: p.101 - p.126

---

# 컴퓨터 성능 향상 기술

- 현대 컴퓨터 구조의 가장 큰 문제점은 `CPU와 메모리, 주변장치의 작업속도가 다르다는 것`이다.
- 메모리와 주변장치는 `시스템 버스`로, CPU 내 레지스터, ALU, 제어장치는 `CPU 내부 버스`로 연결되어 있음.
- **CPU 내부 버스가 시스템 버스보다 속도가 빠르다는 것은 기억하자.**

## 버퍼 (Buffer)

- **두 장치 사이의 속도 차이를 완화하는 역할**
- **일정량의 데이터를 모아 한꺼번에 전송하면 적은 작업량으로도 많은 양의 데이터를 옮길 수 있다.**
- 버퍼가 소프트웨어에서 사용되는 대표적인 예로는 `동영상 스트리밍`이 있다.

## 스풀 (Spool)

- CPU와 입출력장치가 독립적으로 동작하도록 고안된 소프트웨어적인 버퍼
- **대표적으로는 프린터에 사용되는 스풀이 있다.**
- 스풀러가 없으면 워드프로세서가 모든걸 담당해야 해서 인쇄가 끝날 때 까지 워드프로세서를 이용할 수 없다.

## 캐시 (Cache)

- **메모리와 CPU간의 속도차이를 완화하기 위해 메모리의 데이터를 미리 가져와서 저장해두는 임시 저장소**
- CPU가 앞으로 사용할 것으로 예상되는 데이터를 미리 가져다 놓는다 (Prefetch)
- 캐시는 CPU 내부 버스의 속도를 지향한다.
- 캐시 히트(캐시에서 원하는 데이터를 찾았을 때)와 캐시 미스(찾지 못했을 때)
- 컴퓨터 성능 향상을 위해서는 캐시 적중률을 높이면 된다. 그 방법 중 하나는 캐시의 크기를 늘리는 것과 데이터를 가져오는 것이다.
  - 지역성(locality): 가까운 데이터가 멀리 있는 데이터보다 사용될 확률이 더 높다. -> goto문?

### 즉시 쓰기 방식과 지연 쓰기 방식

캐시에 있는 데이터가 변경되면 메모리에 있는 원래 데이터를 변경해야 한다.

- `즉시 쓰기 방식(write through)`: 캐시에 있는 데이터가 변경되면 즉시 메모리에 반영하는 방식
- `지연 쓰기 방식(write back)`: 캐시에 있는 데이터가 변경되면 그 내용을 모아서 주기적으로 반영하는 방식

프로그램의 명령어는 크게 명령어 부분과 데이터 부분으로 나눌 수 있음.<br/>
캐시는 명령어와 데이터의 구분 없이 모든 자료를 가져오는 `일반 캐시`, 구분해서 가져오는 `특수 캐시`라는 레벨로 구분됨.

명령어 캐시(명령어 레지스터와 연결)와 데이터 캐시(데이터 레지스터)는 CPU 레지스터에 직접 연결되기 때문에 L1 Cache 라고 부르고, 일반 캐시는 메모리와 연결되기 때문에 L2 Cache 라고 부른다.

## 인터럽트

### 폴링 방식

> - **CPU가 입출력장치의 상태를 주기적으로 검사해서 일정한 조건을 만족할 때 데이터를 처리한다.**
> - 그래서 CPU가 명령어 해석과 실행이라는 역할 외에 모든 입출력까지 관여해야 하기 때문에 효율이 떨어진다.

인터럽트 방식은 CPU의 작업과 저장장치의 데이터 이동을 독립적으로 운영함으로써 시스템의 효율을 높임.

- CPU가 입출력 관리자에게 입출력 명령을 보낸다.
- 입출력 관리자는 명령받은 데이터를 메모리에 가져다 놓거나 메모리에 있는 데이터를 저장장치로 옮긴다.
- 데이터 전송이 완료되면 입출력 관리자는 CPU에 완료 신호를 보낸다. (인터럽트)

**CPU는 입출력 관리자에게 작업 지시를 내리고 다른 일을 하다가 완료 신호를 받으면 하던 일을 중단하고 옮겨진 데이터를 처리한다.**<br/>
인터럽트 방식에서는 많은 주변장치 중 어떤 장치의 작업이 끝났는지를 CPU에 알려주기 위해 `인터럽트 번호(IRQ)`를 사용한다.

CPU는 입출력 관리자에게 여러 개의 입출력 작업을 동시에 시킬 수 있다. 이 경우에는 여러 작업이 동시에 완료되고 그 때마다 인터럽트를 여러 번 사용해야 하는데 매우 비효율적이다.
그래서 여러 개의 인터럽트를 하나의 배열로 만든 `인터럽트 벡터`를 사용한다.

## 직접 메모리 접근 (DMA: Direct Memory Access)

과거 운영체제는 폴링 방식을 사용했기 때문에 CPU가 메모리나 주변장치에 대한 모든 권한을 가지고 있었다.
하지만, 효율성을 높이기 위해 인터럽트 방식을 사용하면서 입출력 관리자가 데이터 입출력을 맡게 되었다.

## 메모리 맵 입출력 (MMIO: Memory-Mapped I/O)

**메모리의 일정 공간을 입출력에 할당하는 기법**
